add_namespace = EAI_VHTD

#variant
country_event = {
	id = EAI_VHTD.0
	hidden = yes
	
	mean_time_to_happen = { days = 2 }
	
	trigger = {
		is_ai = yes
		has_tech = improved_heavy_td
		NOT = { has_tech = advanced_heavy_td }
		has_war = yes
		NOT = { has_country_flag = htd1_chain_triggered }
		any_enemy_country = { is_neighbor_of = ROOT }
		date > 1939.1.1
		has_country_flag = ha1_complete
		OR = {
			NOT = { has_country_flag = ha2_chain_triggered }
			AND = { has_country_flag = ha2_chain_triggered has_country_flag = ha2_complete }
		}
		enemies_strength_ratio > 0.5
	}
	
	immediate = {
		set_country_flag = htd1_chain_triggered
		country_event = EAI_VHTD.1
	}
	
	option = { name = "OK" }
}

country_event = {
	id = EAI_VHTD.1
	hidden = yes
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = { has_tech = improved_heavy_td NOT = { has_tech = advanced_heavy_td } }
			create_equipment_variant = { 
				name = "H-TD II A"
				type = heavy_tank_destroyer_equipment_2
				upgrades = { 
					tank_at_upgrade = 2
					tank_armor_upgrade = 0
					tank_reliability_upgrade = 0
				}
			}
			country_event = { id = EAI_VHTD.2 days = 20 random = 10 }
			army_experience = -25
		}
	}
	
	option = { name = "OK" }
}

country_event = {
	id = EAI_VHTD.2
	hidden = yes
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = { has_tech = improved_heavy_td NOT = { has_tech = advanced_heavy_td } }
			create_equipment_variant = { 
				name = "H-TD II B" 
				type = heavy_tank_destroyer_equipment_2
				upgrades = { 
					tank_at_upgrade = 3
					tank_armor_upgrade = 0
					tank_reliability_upgrade = 1
				}
			}
			country_event = { id = EAI_VHTD.3 days = 40 random = 10 }
			army_experience = -45
		}
	}
	
	option = { name = "OK" }
}

country_event = {
	id = EAI_VHTD.3
	hidden = yes
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = { has_tech = improved_heavy_td NOT = { has_tech = advanced_heavy_td } }
			create_equipment_variant = { 
				name = "H-TD II C" 
				type = heavy_tank_destroyer_equipment_2
				upgrades = { 
					tank_at_upgrade = 5
					tank_armor_upgrade = 0
					tank_reliability_upgrade = 2
				}
			} 
			army_experience = -105
			set_country_flag = htd1_complete
		}
		
	}
	option = { name = "OK" }
}







#variant
country_event = {
	id = EAI_VHTD.6
	hidden = yes
	
	mean_time_to_happen = { days = 2 }
	
	trigger = {
		is_ai = yes
		has_tech = advanced_heavy_td
		has_war = yes
		NOT = { has_country_flag = htd2_chain_triggered }
		OR = { any_enemy_country = { is_neighbor_of = ROOT } has_country_flag = htd1_chain_triggered }
		date > 1939.1.1
		has_country_flag = ha2_complete
	}
	
	immediate = {
		set_country_flag = htd2_chain_triggered
		set_country_flag = htd1_complete
		country_event = EAI_VHTD.7
	}
	
	option = { name = "OK" }
}

country_event = {
	id = EAI_VHTD.7
	hidden = yes
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = { has_tech = advanced_heavy_td }
			create_equipment_variant = { 
				name = "H-TD III A"
				type = heavy_tank_destroyer_equipment_3
				upgrades = { 
					tank_at_upgrade = 2
					tank_armor_upgrade = 0
					tank_reliability_upgrade = 0
				}
			}
			country_event = { id = EAI_VHTD.8 days = 20 random = 10 }
			army_experience = -25
		}
	}
	
	option = { name = "OK" }
}

country_event = {
	id = EAI_VHTD.8
	hidden = yes
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = { has_tech = advanced_heavy_td }
			create_equipment_variant = { 
				name = "H-TD III B"
				type = heavy_tank_destroyer_equipment_3
				upgrades = { 
					tank_at_upgrade = 3
					tank_armor_upgrade = 0
					tank_reliability_upgrade = 1
				}
			}
			country_event = { id = EAI_VHTD.9 days = 40 random = 10 }
			army_experience = -45
		}
	}
	
	option = { name = "OK" }
}

country_event = {
	id = EAI_VHTD.9
	hidden = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = { has_tech = advanced_heavy_td }
			create_equipment_variant = { 
				name = "H-TD III C"
				type = heavy_tank_destroyer_equipment_3
				upgrades = { 
					tank_at_upgrade = 5
					tank_armor_upgrade = 0
					tank_reliability_upgrade = 2
				}
			} 
			set_country_flag = htd2_complete
			army_experience = -105
		}
		
	}
	option = { name = "OK" }
}